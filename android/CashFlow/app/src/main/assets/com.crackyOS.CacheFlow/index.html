<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./src/mdl/googleAPI-style.css" />
    <link rel="stylesheet" href="./src/mdl/mdl-style.css" />
    <link rel="stylesheet" href="./src/css/style.css" />
    <script src="./src/mdl/mdl-script.js"></script>
    <script src="./src/js/sections.js"></script>
    <script src="./src/js/chart.js"></script>
  </head>

  <style>
    .section {
      display: none !important;
    }

    .active {
      display: block !important;
    }

    .chart-container {
            width: 310px;
            height: 180px;
    }
    canvas {
        width: 310px !important;
        height: 180px !important;
    }
  </style>

  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <span class="mdl-layout-title" id="masterTitle">CashFlow</span>
          <div class="mdl-layout-spacer"></div>
          <nav class="mdl-navigation mdl-layout--large-screen-only">
            <!--icons-->
          </nav>
        </div>
      </header>
      <div class="mdl-layout__drawer">
        <span class="mdl-layout-title" id="menuTitle">Menü</span>
        <nav class="mdl-navigation">
          <a class="mdl-navigation__link" href="">Link</a>
          <a class="mdl-navigation__link" href="">Link</a>
        </nav>
      </div>
      <main class="mdl-layout__content">
        <div class="page-content">
          <center>
            <div id="mainSection" class="section active">
              <br />
              <div id="diagramm" class="diagramm" onclick="show_section('historySection');">
                <div style="width: 600px; height: 400px;">
                    <canvas id="balanceChart"></canvas>
                </div>
            
                <script>
                    // Beispiel-Daten im LocalStorage (für Testzwecke)
                    localStorage.setItem('balanceHistory', JSON.stringify(["+100", "-50", "+75", "-30", "+150", "-90"]));
            
                    // JavaScript-Code für das Diagramm
                    const ctx = document.getElementById('balanceChart').getContext('2d');
                    const balanceHistory = JSON.parse(localStorage.getItem('balanceHistory'));
            
                    const data = balanceHistory.map(entry => parseFloat(entry));
            
                    const labels = balanceHistory.map((_, index) => `Eintrag ${index + 1}`);
            
                    const backgroundColors = data.map(value => value >= 0 ? 'rgba(0, 255, 0, 0.2)' : 'rgba(255, 0, 0, 0.2)');
                    const borderColors = data.map(value => value >= 0 ? 'rgba(0, 255, 0, 1)' : 'rgba(255, 0, 0, 1)');
            
                    const config = {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Balance History',
                                data: data,
                                backgroundColor: backgroundColors,
                                borderColor: borderColors,
                                borderWidth: 2,
                                fill: false,
                                pointBackgroundColor: borderColors,
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    min: Math.min(...data) * 1.1,
                                    max: Math.max(...data) * 1.1
                                }
                            }
                        }
                    };
            
                    const balanceChart = new Chart(ctx, config);
                </script>
              </div>
              <br>
              <button onclick="show_section('increaseSection');"
              class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">
                mehrung
              </button>&nbsp;
              <button onclick="show_section('decreaseSection');"
              class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">
                minderung
              </button>
            </div>
            <div id="historySection" class="section">
              <h4>historySection</h4>
            </div>
            <div id="increaseSection" class="section">
              <h4>increaseSection</h4>
            </div>
            <div id="decreaseSection" class="section">
              <h4>decreaseSection</h4>
            </div>

            <div id="pinSection" class="section">
              <h4>pinSection</h4>
            </div>
          </center>
        </div>
      </main>
    </div>
  </body>
</html>
